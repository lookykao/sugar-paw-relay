<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Auth Relay Â· SugarPaw</title>
    <meta name="robots" content="noindex,nofollow" />
    <style>
      body {
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          "Noto Sans", "Helvetica Neue", Arial, "Apple Color Emoji",
          "Segoe UI Emoji";
        background: #fff8f3;
        color: #333;
        margin: 0;
        display: grid;
        place-items: center;
        height: 100vh;
      }
      .card {
        background: #fff;
        border: 1px solid #eee;
        border-radius: 16px;
        padding: 20px 24px;
        box-shadow: 0 6px 24px rgba(0, 0, 0, 0.06);
        text-align: center;
      }
      .muted {
        color: #888;
        font-size: 12px;
        margin-top: 8px;
      }
      code {
        background: #f6f6f6;
        padding: 2px 6px;
        border-radius: 6px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div>æ­£åœ¨å®‰å…¨è½‰è·³ä¸­â€¦</div>
      <div class="muted">è‹¥æœªè‡ªå‹•è·³è½‰ï¼Œè«‹ç¨å€™æˆ–æ‰‹å‹•è¿”å› App</div>
      <div class="muted">
        <code>/auth/relay</code> â†’ <code>/auth/callback</code>
      </div>
    </div>

    <script>
      (function () {
        // ğŸ‘‰ æ”¹æˆä½ çš„ä¸»ç«™ç¶²å€ï¼ˆèƒ½è™•ç† /auth/callback çš„é‚£å€‹ï¼‰
        // ä¾‹ï¼šVercel Web ç«™ https://sugar-paw.vercel.app æˆ–ä½ çš„è‡ªè¨‚ç¶²åŸŸ
        const MAIN_ORIGIN = "https://sugar-paw.vercel.app";

        // å…è¨±ä»¥æŸ¥è©¢åƒæ•¸è¦†è“‹ï¼ˆå¯é¸ï¼‰ï¼š?origin=https://your-site.app
        const url = new URL(window.location.href);
        const overrideOrigin = url.searchParams.get("origin");
        const targetOrigin = overrideOrigin || MAIN_ORIGIN;

        // æŠŠ Supabase é™„å¸¶çš„ queryï¼ˆå« type=recovery & nextï¼‰èˆ‡ #hash token ä¸€èµ·å¸¶å›ä¸»ç«™
        const search = window.location.search || "";
        const hash = window.location.hash || "";

        // ç›®æ¨™ï¼šä¸»ç«™ /auth/callback?type=...&next=...#access_token=...
        const target = `${targetOrigin.replace(
          /\/+$/,
          ""
        )}/auth/callback${search}${hash}`;

        // ä½¿ç”¨ replace ä¸ç•™ä¸­ç¹¼åœ¨ç€è¦½ç´€éŒ„
        try {
          window.location.replace(target);
        } catch {
          window.location.href = target;
        }
      })();
    </script>
  </body>
</html>
